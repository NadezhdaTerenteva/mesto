(()=>{"use strict";class e{constructor(e,t,s,o){this._name=e,this._link=t,this._template=s,this._handleCardClick=o}createCard(){this._item=this._template.content.cloneNode(!0),this._item.querySelector(".photo-grid__item-name").textContent=this._name;const e=this._item.querySelector(".photo-grid__item-img");return e.src=this._link,e.alt=this._name,this._setEventListeners(),this._item}_handleRemoveCard(e){e.target.closest(".photo-grid__item").remove()}_likeImage(e){e.target.classList.toggle("photo-grid__item-like-icon_active")}_setEventListeners(){this._item.querySelector(".photo-grid__remove-button").addEventListener("click",(e=>{this._handleRemoveCard(e)})),this._item.querySelector(".photo-grid__item-like-icon").addEventListener("click",(e=>{this._likeImage(e)})),this._item.querySelector(".photo-grid__item-img").addEventListener("click",(()=>{this._handleCardClick(this._name,this._link)}))}}class t{constructor(e,t){this._config=e,this._form=t,this._button=this._form.querySelector(this._config.submitButtonSelector),this._inputs=Array.from(this._form.querySelectorAll(this._config.inputSelector))}_toggleButton(){const e=!this._form.checkValidity();this._button.disabled=e,this._button.classList.toggle(this._config.inactiveButtonClass,e)}resetValidation(){this._form.reset(),this._toggleButton()}_setEventListeners(){this._inputs.forEach((e=>{e.addEventListener("input",(e=>this._handleFormInput(e)))})),this._toggleButton()}_handleFormInput(e){const t=e.target,s=this._form.querySelector(`#${t.id}-error`);t.validity.valid?(s.textContent="",s.classList.remove(this._config.errorClass),t.classList.remove(this._config.inputErrorClass)):(s.textContent=t.validationMessage,s.classList.add(this._config.errorClass),t.classList.add(this._config.inputErrorClass)),this._toggleButton()}enableValidation(){this._setEventListeners()}}const s={},o=document.querySelector(".card__item"),i=document.querySelector(".profile__edit-button"),r=document.querySelector(".profile__add-button");document.querySelectorAll(".photo-grid__remove-button");class n{constructor(e){this._popup=document.querySelector(e),this._popupCloseButton=document.querySelector(".popup__close-button"),this._form=this._popup.querySelector(".popup__form"),this._handleEscClose=this._handleEscClose.bind(this)}openPopup(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}closePopup(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.closePopup()}setEventListeners(){this._popup.addEventListener("mousedown",(e=>{e.target.classList.contains("popup_opened")&&this.closePopup(e),e.target.classList.contains("popup__close-button")&&this.closePopup()}))}}class p extends n{constructor({popupSelector:e,handleFormSubmit:t,formValidators:s}){super(e),this._form=this._popup.querySelector(".popup__form"),this._handleFormSubmit=t,this._inputList=this._form.querySelectorAll(".popup__input"),this._formValidators=s,this._validator=this._formValidators[this._form.getAttribute("name")]}_getInputValues(){return this._formValues={},this._inputList.forEach((e=>this._formValues[e.name]=e.value)),this._formValues}setInputValues(e){this._inputList.forEach((t=>{e.hasOwnProperty(t.name)&&(t.value=e[t.name])}))}setEventListeners(){this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this.closePopup()})),super.setEventListeners()}closePopup(){super.closePopup(),this._validator&&this._validator.resetValidation()}}const l=new class extends n{constructor(e){super(e),this._imagePreview=this._popup.querySelector(".popup__photo-preview-img"),this._imagePreviewTitle=this._popup.querySelector(".popup__photo-preview-title")}openPopup(e){this._imagePreviewTitle.textContent=e.name,this._imagePreview.src=e.link,this._imagePreview.alt=e.name,super.openPopup()}}("#popup-preview");l.setEventListeners();const a=new class{constructor({titleSelector:e,subtitleSelector:t}){this._profileTitle=document.querySelector(e),this._profileSubTitle=document.querySelector(t)}getUserInfo(){return{name:this._profileTitle.textContent,job:this._profileSubTitle.textContent}}setUserInfo({name:e,job:t}){this._profileTitle.textContent=e,this._profileSubTitle.textContent=t}}({titleSelector:".profile__title",subtitleSelector:".profile__subtitle"}),c=function(e,t){l.openPopup({name:e,link:t})};function u(t,s){return new e(t,s,o,c).createCard()}const _=new class{constructor({items:e,renderer:t},s){this._renderedItems=e,this._renderer=t,this._container=document.querySelector(s)}renderItems(){this._renderedItems.forEach((e=>this._renderer(e)))}addItem(e){this._container.prepend(e)}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:e=>{_.addItem(u(e.name,e.link))}},".photo-grid__items");var d;_.renderItems(),d={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__submit-button_disabled",inputErrorClass:"popup__input_type-error",errorClass:"popup__error-visible"},Array.from(document.querySelectorAll(d.formSelector)).forEach((e=>{const o=new t(d,e),i=e.getAttribute("name");s[i]=o,o.enableValidation()}));const h=new p({popupSelector:"#popup-place",handleFormSubmit:e=>{_.addItem(u(e.place,e.link)),h.closePopup()},formValidators:s});h.setEventListeners();const m=new p({popupSelector:"#popup-profile",handleFormSubmit:e=>{a.setUserInfo({name:e.name,job:e.job}),m.closePopup()},formValidators:s});m.setEventListeners(),i.addEventListener("click",(e=>{const t=a.getUserInfo();m.setInputValues(t),m.openPopup(e)})),r.addEventListener("click",(e=>h.openPopup(e)))})();